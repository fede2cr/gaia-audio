/* ─────────────────────────────────────────────────────────────────────────────
   Gaia Audio — Dark-theme Stylesheet
   ────────────────────────────────────────────────────────────────────────── */

:root {
    --bg:             #0f1117;
    --bg-card:        #1a1d27;
    --bg-elevated:    #242836;
    --text:           #e4e6ed;
    --text-muted:     #9196a8;
    --accent:         #4ecdc4;
    --accent-dim:     #3aab9f;
    --danger:         #ff6b6b;
    --warning:        #ffd93d;
    --success:        #6bcb77;
    --radius:         8px;
    --shadow:         0 2px 8px rgba(0,0,0,.35);
    --font:           'Inter', 'Segoe UI', system-ui, sans-serif;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { font-size: 15px; }

body {
    font-family: var(--font);
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
}

a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

button {
    font-family: var(--font);
    cursor: pointer;
}

/* ── Navigation ─────────────────────────────────────────────────────────── */

.nav-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: .75rem 1.5rem;
    background: var(--bg-card);
    border-bottom: 1px solid rgba(255,255,255,.06);
    position: sticky;
    top: 0;
    z-index: 100;
}

.nav-logo {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--accent);
}
.nav-logo:hover { text-decoration: none; }

.nav-links { display: flex; gap: 1.25rem; }

.nav-link {
    color: var(--text-muted);
    font-weight: 500;
    transition: color .2s;
}
.nav-link:hover,
.nav-link[aria-current="page"] {
    color: var(--accent);
    text-decoration: none;
}

/* ── Main layout ────────────────────────────────────────────────────────── */

.main-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1.5rem;
}

/* ── Loading / error ────────────────────────────────────────────────────── */

.loading {
    text-align: center;
    color: var(--text-muted);
    padding: 2rem;
}
.error {
    color: var(--danger);
    padding: 1rem;
    background: rgba(255,107,107,.08);
    border-radius: var(--radius);
}

/* ── Home page ──────────────────────────────────────────────────────────── */

.home-page {
    display: grid;
    grid-template-columns: 1fr 340px;
    gap: 1.5rem;
}
@media (max-width: 860px) {
    .home-page { grid-template-columns: 1fr; }
}

.live-feed h1,
.top-species h2 {
    margin-bottom: 1rem;
    font-size: 1.15rem;
    letter-spacing: .02em;
}

.feed-list {
    display: flex;
    flex-direction: column;
    gap: .5rem;
}

/* ── Detection Card ─────────────────────────────────────────────────────── */

.detection-card {
    display: flex;
    align-items: stretch;
    gap: .75rem;
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: .65rem .9rem;
    box-shadow: var(--shadow);
    transition: transform .15s, box-shadow .15s;
}
.detection-card:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,.45);
}

/* Spectrogram thumbnail */
.detection-spectrogram {
    flex-shrink: 0;
    width: 180px;
    min-height: 56px;
    border-radius: 4px;
    overflow: hidden;
    background: var(--bg-elevated);
}
.detection-spectrogram img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}
@media (max-width: 600px) {
    .detection-card { flex-direction: column; }
    .detection-spectrogram { width: 100%; max-height: 80px; }
}

.detection-info { flex: 1; min-width: 0; }

.detection-species {
    display: flex;
    flex-direction: column;
}
.common-name { font-weight: 600; color: var(--text); }
.sci-name    { font-size: .82rem; color: var(--text-muted); font-style: italic; }

.detection-meta {
    display: flex;
    gap: .5rem;
    align-items: center;
    margin-top: .25rem;
    font-size: .82rem;
    flex-wrap: wrap;
}

.detection-timestamp {
    display: flex;
    gap: .3rem;
    align-items: center;
    margin-top: .2rem;
    font-size: .8rem;
    color: var(--text-muted);
}
.icon-clock { color: var(--text-muted); flex-shrink: 0; }

.detection-time { color: var(--text-muted); }

/* Source node badge */
.source-badge {
    padding: .1rem .45rem;
    border-radius: 4px;
    font-size: .72rem;
    font-weight: 500;
    letter-spacing: .02em;
    background: rgba(147,130,220,.12);
    color: #a99de0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 180px;
}

/* Audio player */
.detection-audio {
    width: 100%;
    height: 32px;
    margin-top: .35rem;
    border-radius: 4px;
    opacity: .85;
}
.detection-audio:hover { opacity: 1; }

/* Confidence badges */
.confidence       { padding: .1rem .4rem; border-radius: 4px; font-weight: 600; font-size: .78rem; }
.confidence.high  { background: rgba(107,203,119,.15); color: var(--success); }
.confidence.medium{ background: rgba(255,217,61,.12);  color: var(--warning); }
.confidence.low   { background: rgba(255,107,107,.12); color: var(--danger); }

/* Domain badge */
.domain-badge {
    padding: .1rem .45rem;
    border-radius: 4px;
    font-size: .75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: .04em;
    background: rgba(78,205,196,.12);
    color: var(--accent);
}

/* ── Species Card ───────────────────────────────────────────────────────── */

.species-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: .75rem;
}
.species-grid.full {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
}

.species-card {
    display: flex;
    flex-direction: column;
    background: var(--bg-card);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: transform .15s, box-shadow .15s;
    color: var(--text);
}
.species-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,0,0,.5);
    text-decoration: none;
}

.species-img-wrap {
    width: 100%;
    padding-top: 75%; /* 4:3 aspect ratio */
    position: relative;
    background: var(--bg-elevated);
}
.species-img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.species-card-body { padding: .6rem .75rem; }
.species-common    { font-size: .95rem; font-weight: 600; margin: 0; }
.species-sci       { font-size: .78rem; color: var(--text-muted); font-style: italic; margin: .15rem 0 .3rem; }
.species-stats     { display: flex; gap: .4rem; align-items: center; font-size: .78rem; }
.detection-count   { color: var(--text-muted); }

/* ── Calendar ───────────────────────────────────────────────────────────── */

.calendar-page {
    max-width: 800px;
    margin: 0 auto;
}

.cal-nav {
    display: flex;
    gap: .75rem;
    margin-bottom: 1rem;
}
.cal-nav-btn {
    padding: .4rem 1rem;
    background: var(--bg-card);
    color: var(--accent);
    border: 1px solid rgba(78,205,196,.25);
    border-radius: var(--radius);
    font-weight: 500;
    transition: background .2s;
}
.cal-nav-btn:hover {
    background: var(--bg-elevated);
}

.calendar { margin-bottom: 2rem; }

.cal-header h2 {
    font-size: 1.2rem;
    margin-bottom: .75rem;
}

.cal-weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
    font-size: .78rem;
    color: var(--text-muted);
    text-align: center;
    padding-bottom: .3rem;
    border-bottom: 1px solid rgba(255,255,255,.06);
    margin-bottom: 4px;
}

.cal-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 3px;
}

.cal-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 52px;
    border-radius: 6px;
    padding: .25rem;
    background: var(--bg-card);
    text-align: center;
    font-size: .82rem;
    color: var(--text);
    transition: background .2s;
}
.cal-cell:hover {
    text-decoration: none;
    background: var(--bg-elevated);
}
.cal-cell.empty { background: transparent; }

.cal-cell.has-data {
    background: rgba(78,205,196, calc(var(--intensity, 0) * 0.008 + 0.06));
    border: 1px solid rgba(78,205,196, calc(var(--intensity, 0) * 0.005 + 0.08));
}
.cal-cell.highlighted {
    background: rgba(78,205,196,.22);
    border: 1px solid var(--accent);
}

.cal-day-num   { font-weight: 600; }
.cal-day-stats { font-size: .68rem; color: var(--text-muted); }

/* ── Day page ───────────────────────────────────────────────────────────── */

.day-page h1 { margin-bottom: .5rem; }
.back-link   { display: inline-block; margin-bottom: 1rem; font-size: .9rem; }

.day-summary {
    color: var(--text-muted);
    margin-bottom: 1rem;
}

.day-groups {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
}

.day-group {
    background: var(--bg-card);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
}

.day-group-header {
    display: flex;
    gap: 1rem;
    padding: .85rem;
    align-items: center;
    background: var(--bg-elevated);
}
.day-group-img {
    width: 64px;
    height: 64px;
    border-radius: 6px;
    object-fit: cover;
    background: var(--bg);
}
.day-group-info {
    display: flex;
    flex-wrap: wrap;
    gap: .4rem .8rem;
    align-items: center;
}
.day-group-name { font-size: 1rem; }

.day-group-detections {
    padding: .5rem .85rem .85rem;
    display: flex;
    flex-direction: column;
    gap: .4rem;
}

/* ── Species detail page ────────────────────────────────────────────────── */

.species-page { max-width: 900px; margin: 0 auto; }

.species-hero {
    display: flex;
    gap: 1.5rem;
    margin: 1rem 0 2rem;
}
@media (max-width: 640px) {
    .species-hero { flex-direction: column; }
}

.species-hero-img {
    width: 260px;
    height: 260px;
    border-radius: var(--radius);
    object-fit: cover;
    background: var(--bg-card);
    flex-shrink: 0;
}
@media (max-width: 640px) {
    .species-hero-img { width: 100%; height: 220px; }
}

.species-hero-info { flex: 1; }
.species-hero-info h1 { font-size: 1.5rem; margin-bottom: .15rem; }
.species-sci-name { color: var(--text-muted); font-style: italic; margin-bottom: .5rem; }

.species-stats-bar {
    display: flex;
    gap: 1.5rem;
    margin: 1rem 0;
}
.stat { display: flex; flex-direction: column; }
.stat-value { font-size: 1.15rem; font-weight: 700; color: var(--accent); }
.stat-label { font-size: .75rem; color: var(--text-muted); }

.wiki-link {
    display: inline-block;
    margin-top: .5rem;
    padding: .35rem .8rem;
    background: var(--bg-elevated);
    border-radius: var(--radius);
    font-size: .85rem;
}

.species-calendar {
    margin-top: 1.5rem;
}
.species-calendar h2 {
    font-size: 1.1rem;
    margin-bottom: 1rem;
}

/* ── Species list page ──────────────────────────────────────────────────── */

.species-list-page h1 {
    margin-bottom: 1.25rem;
}

/* ── Utility ────────────────────────────────────────────────────────────── */

::selection {
    background: var(--accent);
    color: var(--bg);
}

::-webkit-scrollbar {
    width: 8px;
}
::-webkit-scrollbar-track {
    background: var(--bg);
}
::-webkit-scrollbar-thumb {
    background: var(--bg-elevated);
    border-radius: 4px;
}

/* ─── Import page ─────────────────────────────────────────────────────────── */
.import-page {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
}
.import-page h1 {
    margin-bottom: 0.25rem;
}
.import-desc {
    color: var(--text-dim);
    margin-bottom: 1.5rem;
}
.import-desc code {
    background: var(--bg-elevated);
    padding: 0.1em 0.4em;
    border-radius: 3px;
}

.import-input-row {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1rem;
}
.import-path-input {
    flex: 1;
    padding: 0.5rem 0.75rem;
    font-size: 0.95rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--bg-elevated);
    color: var(--text);
}
.import-path-input::placeholder {
    color: var(--text-dim);
}

.btn {
    padding: 0.5rem 1.25rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.9rem;
    transition: opacity 0.15s;
}
.btn:disabled {
    opacity: 0.5;
    cursor: wait;
}
.btn-primary {
    background: var(--accent);
    color: var(--bg);
}
.btn-success {
    background: #22c55e;
    color: #fff;
}

.import-error {
    background: #f871714d;
    color: #fca5a5;
    padding: 0.75rem 1rem;
    border-radius: 6px;
    margin-bottom: 1rem;
}

/* Report card grid */
.import-report,
.import-result {
    margin-top: 1.5rem;
}
.report-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}
.report-card {
    background: var(--bg-elevated);
    border-radius: 8px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}
.report-card-success {
    border-left: 3px solid #22c55e;
}
.report-label {
    font-size: 0.8rem;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.03em;
}
.report-value {
    font-size: 1.35rem;
    font-weight: 700;
}

/* Top species table */
.report-table {
    width: 100%;
    border-collapse: collapse;
    margin: 0.75rem 0 1.5rem;
}
.report-table th,
.report-table td {
    padding: 0.5rem 0.75rem;
    text-align: left;
    border-bottom: 1px solid var(--border);
}
.report-table th {
    color: var(--text-dim);
    font-size: 0.8rem;
    text-transform: uppercase;
}
.report-location {
    color: var(--text-dim);
    margin: 0.5rem 0 1rem;
}
.import-actions {
    margin-top: 1rem;
}

/* Error details */
.import-errors {
    margin-top: 1rem;
    background: var(--bg-elevated);
    border-radius: 6px;
    padding: 0.75rem 1rem;
}
.import-errors summary {
    cursor: pointer;
    color: #fca5a5;
    font-weight: 600;
}
.import-errors ul {
    margin: 0.5rem 0 0 1.25rem;
    font-size: 0.85rem;
    color: var(--text-dim);
}
